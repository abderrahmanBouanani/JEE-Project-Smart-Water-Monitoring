@startuml use_cases
!theme plain
title Diagramme UML des cas d'utilisation - Smart Water Monitoring System

left to right direction

package "Système Smart Water Monitoring" {
    
    ' Cas d'utilisation - Authentification
    (UC-01 : S'inscrire) as UC01
    (UC-02 : S'authentifier) as UC02
    (UC-03 : Se déconnecter) as UC03
    
    ' Cas d'utilisation - Consommation Citoyen
    (UC-04 : Visualiser consommation) as UC04
    (UC-05 : Définir objectif) as UC05
    (UC-06 : Consulter alertes) as UC06
    
    ' Cas d'utilisation - Gestion Capteurs
    (UC-07 : Ajouter capteur) as UC07
    (UC-08 : Recevoir données IoT) as UC08
    
    ' Cas d'utilisation - Alertes
    (UC-09 : Générer alertes) as UC09
    
    ' Cas d'utilisation - Agrégation
    (UC-10 : Agréger quotidiennement) as UC10
    
    ' Cas d'utilisation - Admin
    (UC-11 : Consulter statistiques) as UC11
}

' Acteurs
actor "Citoyen" as Citizen
actor "Administrateur" as Admin
actor "Capteur IoT" as Sensor
actor "Job Planifié" as Job

' Relations Citoyen
Citizen --> UC01
Citizen --> UC02
Citizen --> UC03
Citizen --> UC04
Citizen --> UC05
Citizen --> UC06

' Relations Administrateur
Admin --> UC02
Admin --> UC03
Admin --> UC07
Admin --> UC11

' Relations Capteur IoT
Sensor --> UC08

' Relations Job Planifié
Job --> UC10

' Extensions et inclusions
UC02 ..> UC04 : <<include>>
UC02 ..> UC06 : <<include>>
UC02 ..> UC05 : <<include>>

UC04 ..> UC06 : <<include>>

UC08 ..> UC09 : <<include>>

UC10 ..> UC09 : <<include>>

UC07 --> UC08 : prérequis

note right of UC01
  S'inscrire
  - Validations email/pwd
  - Hash BCrypt
end note

note right of UC02
  S'authentifier
  - Vérification BCrypt
  - Création session
end note

note right of UC04
  Visualiser consommation
  - Temps réel (< 1min)
  - Historique (jour/mois/an)
  - Graphiques interactifs
end note

note right of UC05
  Objectifs mensuels
  - Définition personnalisée
  - Suivi progression
  - Alertes de dépassement
end note

note right of UC06
  Alertes utilisateur
  - FUITE, SURCONSOMMATION
  - Marquer comme lue
  - Historique
end note

note right of UC07
  Admin gère capteurs
  - Ajout, modification
  - Association utilisateur
  - Configuration seuils
end note

note right of UC08
  API REST collecte données
  - Endpoint: /api/waterdata
  - Format JSON
  - Validation et stockage
end note

note right of UC09
  Génération automatique
  - Seuils: 40L/min, 150%
  - Niveau d'urgence
  - Notification utilisateur
end note

note right of UC10
  Job quotidien 00:30
  - Calcul statistiques
  - Agrégation données
  - Génération rapports
end note

note right of UC11
  Dashboard admin
  - Stats globales
  - Tendances réseau
  - Diagnostic anomalies
end note

@enduml
