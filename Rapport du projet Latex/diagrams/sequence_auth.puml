@startuml sequence_auth
!theme plain
title Diagramme de séquence : Authentification utilisateur

participant "Client" as Client
participant "AuthServlet" as Auth
participant "Service" as Service
participant "DAO" as DAO
participant "Base de Données" as DB

Client -> Auth: POST /auth\n(email, password)
activate Auth

Auth -> Service: findByEmail(email)
activate Service

Service -> DAO: Chercher utilisateur
activate DAO

DAO -> DB: SELECT utilisateurs WHERE email
activate DB
DB --> DAO: Utilisateur trouvé
deactivate DB

DAO --> Service: Utilisateur
deactivate DAO

Service --> Auth: Utilisateur
deactivate Service

alt Utilisateur existe
    Auth -> Auth: Vérifier password (BCrypt 12 rounds)
    
    alt Password correct
        Auth -> Auth: Créer session\nHttpSession
        Auth --> Client: HTTP 302 Redirect\n/dashboard
        
    else Password incorrect
        Auth --> Client: HTTP 401\nErreur authentification
    end
    
else Utilisateur non trouvé
    Auth --> Client: HTTP 401\nUtilisateur introuvable
end

deactivate Auth

note over Client, DB
    Sécurité : BCrypt hash 12 rounds
    Temps : < 200ms
end note

@enduml
